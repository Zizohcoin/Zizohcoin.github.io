<script type="module">
  import {
    Connection,
    PublicKey,
    clusterApiUrl
  } from "https://cdn.jsdelivr.net/npm/@solana/web3.js@1.73.3/+esm";

  const ZOH_MINT = "22qVsVm2dyFg5WC72hQTdh92GgFqwboAQ7TMAHhfpump";

  async function checkIfHasZOH(walletAddress) {
    const connection = new Connection(clusterApiUrl("mainnet-beta"), "confirmed");
    const ownerPublicKey = new PublicKey(walletAddress);
    const tokenAccounts = await connection.getParsedTokenAccountsByOwner(ownerPublicKey, {
      programId: new PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),
    });

    for (const { account } of tokenAccounts.value) {
      const mint = account.data.parsed.info.mint;
      const amount = account.data.parsed.info.tokenAmount.uiAmount;

      if (mint === ZOH_MINT && amount > 0) {
        return true;
      }
    }

    return false;
  }

  // exemplo de uso
  const input = document.getElementById("wallet");
  const resultDiv = document.getElementById("resultado");

  document.getElementById("verificar").addEventListener("click", async () => {
    const address = input.value.trim();
    resultDiv.innerText = "🔍 Verificando...";

    try {
      const hasZOH = await checkIfHasZOH(address);
      if (hasZOH) {
        resultDiv.innerHTML = "✅ ZOH detectado! Acesso liberado à ferramenta.";
        // aqui você pode mostrar sua ferramenta
        document.getElementById("ferramenta").style.display = "block";
      } else {
        resultDiv.innerHTML = "❌ Você não possui ZOH nessa carteira.";
      }
    } catch (e) {
      console.error(e);
      resultDiv.innerHTML = "⚠️ Erro ao verificar a carteira. Verifique se o endereço é válido.";
    }
  });
</script>
